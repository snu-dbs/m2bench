select count(tid) from (select distinct(tag_id) as tid from (select out('Interested_in').tag_id as tag_id from Person where person_id in (select person_id from (select in('Follows').size() as follower, person_id from Person where person_id in (select person_id from Customer where customer_id in (select distinct customer_id from (select customer_id, product_id,total_spent from (select customer_id, order_line.product_id as product_id, sum(order_line.price) as total_spent from Order group by customer_id unwind order_line, product_id, price) where total_spent>10000 and product_id in (select product_id from Product where brand_id in (select brand_id from Brand where industry = "Leisure"))))) group by person_id order by follower desc limit 10)) unwind tag_id))
